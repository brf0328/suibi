# ä½¿ç”¨èˆé€‰é‡‡æ ·æ³•ç”Ÿæˆ Beta(3,2) åˆ†å¸ƒéšæœºæ•°

æœ¬æ–‡ä½¿ç”¨èˆé€‰é‡‡æ ·æ³•ï¼ˆRejection Samplingï¼‰ç”Ÿæˆç¬¦åˆ Beta(3,2) åˆ†å¸ƒçš„éšæœºå˜é‡ï¼Œå¹¶ç»˜åˆ¶æ ·æœ¬ç›´æ–¹å›¾ä¸ç†è®ºå¯†åº¦å‡½æ•°å¯¹æ¯”å›¾ï¼ŒåŒæ—¶è®¡ç®—ç†è®ºä¸å®é™…çš„å¹³å‡è¿­ä»£æ¬¡æ•°ã€‚

---

## ğŸ“Œ é¢˜ç›®

![é¢˜ç›®](https://raw.githubusercontent.com/brf0328/suibi/main/images/timu.png)

---

## ğŸ“¦ Python å®ç°ä»£ç ï¼ˆèˆé€‰é‡‡æ ·ï¼‰

```python
import numpy as np
import matplotlib.pyplot as plt

# è®¾ç½®ä¸­æ–‡å­—ä½“
plt.rcParams['font.sans-serif'] = ['SimHei']
plt.rcParams['axes.unicode_minus'] = False

# Beta(3,2) å¯†åº¦å‡½æ•°
def p(x):
    return 12 * x**2 * (1 - x)

# åŒ…ç»œå‡½æ•° M(x)
def M_func(x):
    if 0 <= x <= 0.8:
        return 3 * x
    elif 0.8 < x <= 1:
        return 12 * (1 - x)
    else:
        return 0

# èˆé€‰é‡‡æ ·å‡½æ•°
def sample_beta_rt():
    count = 0
    while True:
        count += 1
        if np.random.random() < 0.96 / 1.2:
            x = 0.8 * np.sqrt(np.random.random())
        else:
            x = 1 - 0.2 * np.sqrt(np.random.random())

        if np.random.random() <= p(x) / M_func(x):
            return x, count

# é‡‡æ ·
n = 10000
samples = []
total_iters = 0
for _ in range(n):
    x, iters = sample_beta_rt()
    samples.append(x)
    total_iters += iters

# è¿­ä»£æ¬¡æ•°ç»Ÿè®¡
empirical_avg_iters = total_iters / n
theoretical_avg_iters = 1.2  # Mæ€»é¢ç§¯ / pæ€»é¢ç§¯

# ç»˜å›¾
x_vals = np.linspace(0, 1, 200)
y_vals = p(x_vals)
plt.hist(samples, bins=30, density=True, alpha=0.7, edgecolor='black', label='æ ·æœ¬å¯†åº¦ç›´æ–¹å›¾')
plt.plot(x_vals, y_vals, 'r-', linewidth=2, label='ç†è®ºå¯†åº¦å‡½æ•°')
plt.title('èˆé€‰é‡‡æ ·: Beta(3,2)')
plt.xlabel('x')
plt.ylabel('å¯†åº¦')
plt.legend()
plt.show()

# è¾“å‡º
print(f"ç†è®ºå¹³å‡è¿­ä»£æ¬¡æ•°ï¼š{theoretical_avg_iters}")
print(f"å®é™…å¹³å‡è¿­ä»£æ¬¡æ•°ï¼š{empirical_avg_iters:.4f}")
![ç¬”è®°](https://raw.githubusercontent.com/brf0328/suibi/main/images/biji.jpg)
![ç–‘é—®](https://raw.githubusercontent.com/brf0328/suibi/main/images/yiwen.jpg)
