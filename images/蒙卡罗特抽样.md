# 使用舍选采样法生成 Beta(3,2) 分布随机数

本文使用舍选采样法（Rejection Sampling）生成符合 Beta(3,2) 分布的随机变量，并绘制样本直方图与理论密度函数对比图，同时计算理论与实际的平均迭代次数。

---

## 📌 密度函数定义

目标分布 \( \text{Beta}(3,2) \) 的概率密度函数为：

\[
p(x) = 12x^2(1 - x), \quad x \in [0, 1]
\]

包络函数 \( M(x) \) 定义为：

\[
M(x) =
\begin{cases}
3x, & 0 \le x \le 0.8 \\
12(1 - x), & 0.8 < x \le 1 \\
0, & 其他
\end{cases}
\]

---

## 📦 Python 实现代码（舍选采样）

```python
import numpy as np
import matplotlib.pyplot as plt

# 设置中文字体
plt.rcParams['font.sans-serif'] = ['SimHei']
plt.rcParams['axes.unicode_minus'] = False

# Beta(3,2) 密度函数
def p(x):
    return 12 * x**2 * (1 - x)

# 包络函数 M(x)
def M_func(x):
    if 0 <= x <= 0.8:
        return 3 * x
    elif 0.8 < x <= 1:
        return 12 * (1 - x)
    else:
        return 0

# 舍选采样函数
def sample_beta_rt():
    count = 0
    while True:
        count += 1
        if np.random.random() < 0.96 / 1.2:
            x = 0.8 * np.sqrt(np.random.random())
        else:
            x = 1 - 0.2 * np.sqrt(np.random.random())

        if np.random.random() <= p(x) / M_func(x):
            return x, count

# 采样
n = 10000
samples = []
total_iters = 0
for _ in range(n):
    x, iters = sample_beta_rt()
    samples.append(x)
    total_iters += iters

# 迭代次数统计
empirical_avg_iters = total_iters / n
theoretical_avg_iters = 1.2  # M总面积 / p总面积

# 绘图
x_vals = np.linspace(0, 1, 200)
y_vals = p(x_vals)
plt.hist(samples, bins=30, density=True, alpha=0.7, edgecolor='black', label='样本密度直方图')
plt.plot(x_vals, y_vals, 'r-', linewidth=2, label='理论密度函数')
plt.title('舍选采样: Beta(3,2)')
plt.xlabel('x')
plt.ylabel('密度')
plt.legend()
plt.show()

# 输出
print(f"理论平均迭代次数：{theoretical_avg_iters}")
print(f"实际平均迭代次数：{empirical_avg_iters:.4f}")
![笔记]images/1747491215597.jpg
![疑问]images/8125c9a9aab1244f3d6d0047461e5d1.jpg
